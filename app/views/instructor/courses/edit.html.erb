<script>
  $(function(){
    $(".lessons").sortable({
      update: function( event, ui ) {
        $.ajax({
          method: "PUT",
          url: ui.item.data('update-url'),
          dataType: "json",
          data: { lesson: { row_order_position: ui.item.index() } }
        });
    }
    });
  })
</script>

<br class="clear" />
<div class="card-tallbox col-xs-10 col-xs-offset-1">
  <h1><%= current_course.title %></h1>
  <br class="clr" />
  <%= image_tag current_course.image, :class=>"img-responsive" %>
  <br class="clr" />
  <%= link_to 'Preview As Student', course_path(current_course), :class => 'btn btn-warning pull-right' %>
  <br class="clear"/>

  <h3>Sections</h3>
  <br class="clear" />
  <ul>
    <% current_course.sections.order(:id).each do |section| %>
      <div class="section">
        <div class="col-xs-10">
          <h3><%= section.title %></h3>
        </div>
        <div class="col-xs-2">
          <h3><%= link_to 'Add a Lesson', new_instructor_section_lesson_path(section.id), :class => "pull-right btn btn-primary" %></h3>
        </div>
        <br class="clear" />
        <br />
        <div class="lessons">
          <% section.lessons.rank(:row_order).each do |lesson| %>
            <div class="lesson text-center" style="color: white" data-update-url=<%= instructor_lesson_path(lesson) %>>
              <br />
              <h3><%= lesson.title %></h3>
              -
              <h4><%= lesson.transcript %></h4>
              <br class="clear" />
              <br />
            </div>
          <% end %>
        </div>
        <br />
      </div>
    <% end %>
  </ul>
  <br />

  <%= link_to 'Add Section', new_instructor_course_section_path(current_course), :class => "btn btn-primary" %>
  <br />
  <br />
</div>
